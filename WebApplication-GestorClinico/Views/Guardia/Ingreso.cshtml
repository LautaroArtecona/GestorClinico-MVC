@model WebApplication_GestorClinico.Models.Paciente

@{
    ViewData["Title"] = "Nuevo Ingreso";
    Layout = "~/Views/Shared/_LayoutAdmin.cshtml";
}

<div class="container mt-4">
    <div class="row justify-content-center">
        <div class="col-md-8">

            <div class="card shadow-sm border-0">
                <div class="card-header bg-white border-bottom-0 pt-4 pb-0 text-center">
                    <h3 class="text-danger fw-bold"><i class="bi bi-search"></i> Recepción de Guardia</h3>
                    <p class="text-muted">Busque al paciente por DNI</p>
                </div>

                <div class="card-body p-4">

                    <form asp-action="BuscarPaciente" method="post" class="mb-4">
                        <div class="input-group input-group-lg">
                            <input type="text" name="dniBusqueda" class="form-control"
                                   placeholder="Ingrese DNI..."
                                   value="@ViewBag.DniIngresado" autofocus />

                            <button type="submit" class="btn btn-danger">BUSCAR</button>
                        </div>
                    </form>

                    <hr />

                    @if (ViewBag.Error != null)
                    {
                        <div class="alert alert-warning text-center shadow-sm">
                            <i class="bi bi-person-x-fill text-warning fs-1 d-block mb-2"></i>

                            <h4 class="alert-heading fw-bold text-dark">@ViewBag.Error</h4>

                            @if (ViewBag.Error.ToString().Contains("no encontrado"))
                            {
                                <p class="mb-0">El DNI <strong>@ViewBag.DniIngresado</strong> no existe.</p>
                                <hr>
                                <p class="mb-2">¿Desea darlo de alta?</p>
                                <a asp-controller="Paciente" asp-action="Create" class="btn btn-dark px-4 fw-bold">
                                    <i class="bi bi-person-plus-fill"></i> NUEVO PACIENTE
                                </a>
                            }
                        </div>
                    }

                    @if (Model != null)
                    {
                        <div class="card border-success mb-3 bg-light shadow-sm">
                            <div class="card-body d-flex justify-content-between align-items-center">

                                <div>
                                    <h6 class="text-success text-uppercase small mb-1 fw-bold">
                                        <i class="bi bi-check-circle-fill"></i> Paciente Encontrado
                                    </h6>
                                    <h3 class="fw-bold text-dark mb-1">
                                        @Model.Apellido, @Model.Nombre
                                    </h3>
                                    <div class="text-secondary mt-2">
                                        <span class="badge bg-white text-dark border border-secondary me-2">
                                            DNI: @Model.Dni
                                        </span>
                                        <span class="badge bg-primary text-white">
                                            OS: @Model.ObraSocial
                                        </span>
                                    </div>
                                </div>

                                <div>
                                    <form asp-action="ConfirmarIngreso" method="post">
                                        <input type="hidden" name="idPaciente" value="@Model.Id" />
                                        <button type="submit" class="btn btn-success btn-lg shadow fw-bold px-4">
                                            RECEPCIONAR <i class="bi bi-arrow-right"></i>
                                        </button>
                                    </form>
                                </div>

                            </div>
                        </div>
                    }

                </div>

                <div class="card-footer bg-white text-center border-0 pb-4">
                    <a asp-action="Index" class="text-decoration-none text-muted">
                        <i class="bi bi-arrow-left"></i> Volver
                    </a>
                </div>
            </div>

        </div>
    </div>
</div>